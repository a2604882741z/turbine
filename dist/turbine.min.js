!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.turbine=t()}(this,function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=t(function(e,t){function n(e){return"number"==typeof e&&isNaN(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.startsWith=function(e,t,n){return e.substr(n||0,t.length)===t},t.endsWith=function(e,t,n){var r=(n||e.length)-t.length,i=e.lastIndexOf(t,r);return-1!==i&&i===r},t.stringIncludes=function(e,t,n){return-1!==e.indexOf(t,n||0)},t.isRealNaN=n,t.arrayIncludes=function(e,t,r){var i=e.length;if(0===i)return!1;var o=0|r,a=n(t),s=o>=0?o:i+o;for(;s<i;){var u=e[s++];if(u===t)return!0;if(a&&n(u))return!0}return!1}});e(n);n.startsWith,n.endsWith,n.stringIncludes,n.isRealNaN,n.arrayIncludes;var r=t(function(e,t){function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){for(var t=e.str,r=t.length;e.cursor<r;){var i=e.cursor;if(s(e),e.cursor===i)if((0,n.startsWith)(t,"!--",e.cursor+1))u(e);else{var o=c(e),a=o.toLowerCase(),l=e.options.childlessTags;(0,n.arrayIncludes)(l,a)&&v(o,e)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n={str:e,options:t,cursor:0,tokens:[]};return i(n),n.tokens},t.lex=i,t.findTextEnd=a,t.lexText=s,t.lexComment=u,t.lexTag=c,t.isWhitespaceChar=f,t.lexTagName=h,t.lexTagAttributes=d,t.lexSkipTag=v;var o=/[A-Za-z0-9]/;function a(e,t){for(;;){var n=e.indexOf("<",t);if(-1===n)return n;var r=e.charAt(n+1);if("/"===r||"!"===r||o.test(r))return n;t=n+1}}function s(e){var t=e.str,n=e.cursor,r=a(t,n);if(-1===r){var i=t.slice(n);return e.cursor=t.length,void e.tokens.push({type:"text",content:i})}if(r!==n){var o=t.slice(n,r);e.cursor=r,e.tokens.push({type:"text",content:o})}}function u(e){e.cursor+=4;var t=e.str,n=e.cursor,r=t.indexOf("--\x3e",n);if(-1===r){var i=t.slice(n);return e.cursor=t.length,void e.tokens.push({type:"comment",content:i})}var o=t.slice(n,r);e.cursor=r+3,e.tokens.push({type:"comment",content:o})}function c(e){var t=e.str,n="/"===t.charAt(e.cursor+1);e.tokens.push({type:"tag-start",close:n}),e.cursor+=n?2:1;var r=h(e);d(e);var i="/"===t.charAt(e.cursor);return e.tokens.push({type:"tag-end",close:i}),e.cursor+=i?2:1,r}var l=/\s/;function f(e){return l.test(e)}function h(e){for(var t=e.str,n=e.cursor,r=t.length,i=n;i<r;){var o=t.charAt(i);if(!(f(o)||"/"===o||">"===o))break;i++}for(var a=i+1;a<r;){var s=t.charAt(a);if(!!(f(s)||"/"===s||">"===s))break;a++}e.cursor=a;var u=t.slice(i,a);return e.tokens.push({type:"tag",content:u}),u}function d(e){for(var t=e.str,r=e.tokens,i=e.cursor,o=null,a=i,s=[],u=t.length;i<u;){var c=t.charAt(i);if(o){c===o&&(o=null),i++}else{if("/"===c||">"===c){i!==a&&s.push(t.slice(a,i));break}if(f(c))i!==a&&s.push(t.slice(a,i)),a=i+1,i++;else"'"===c||'"'===c?(o=c,i++):i++}}e.cursor=i;for(var l=s.length,h="attribute",d=0;d<l;d++){var v=s[d];if(-1===v.indexOf("=")){var p=s[d+1];if(p&&(0,n.startsWith)(p,"=")){if(p.length>1){var y=v+p;r.push({type:h,content:y}),d+=1;continue}var b=s[d+2];if(d+=1,b){var g=v+"="+b;r.push({type:h,content:g}),d+=1;continue}}}if((0,n.endsWith)(v,"=")){var m=s[d+1];if(m&&!(0,n.stringIncludes)(m,"=")){var _=v+m;r.push({type:h,content:_}),d+=1;continue}var k=v.slice(0,-1);r.push({type:h,content:k})}else r.push({type:h,content:v})}}function v(e,t){for(var n=t.str,i=t.cursor,o=t.tokens,a=n.length,u=i;u<a;){var c=n.indexOf("</",u);if(-1===c){s(t);break}var l={str:n,cursor:c+2,tokens:[]},f=h(l);if(e.toLowerCase()===f.toLowerCase()){var v=n.slice(i,c);o.push({type:"text",content:v});d(l),o.push.apply(o,[{type:"tag-start",close:!0}].concat(r(l.tokens),[{type:"tag-end",close:!1}])),t.cursor=l.cursor+1;break}u=l.cursor}}});e(r);r.lex,r.findTextEnd,r.lexText,r.lexComment,r.lexTag,r.isWhitespaceChar,r.lexTagName,r.lexTagAttributes,r.lexSkipTag;var i=t(function(e,t){function r(e,t,r){var i=r[e];if(i)for(var o=t.length-1;o>=0;){var a=t[o].tagName;if(a===e)break;if((0,n.arrayIncludes)(i,a))return!0;o--}return!1}function i(e){for(var t=e.tokens,o=e.options,a=e.stack,s=a[a.length-1].children,u=t.length,c=e.cursor;c<u;){var l=t[c];if("tag-start"===l.type){var f=t[++c];c++;var h=f.content.toLowerCase();if(l.close){for(var d=a.length,v=!1;--d>-1;)if(a[d].tagName===h){a.splice(d),v=!0;break}for(;c<u;){if("tag-end"!==t[c].type)break;c++}if(v)break}else{var p=(0,n.arrayIncludes)(o.closingTags,h);if(p)p=!r(h,a,o.closingTagAncestorBreakers);if(p)for(var y=a.length-1;y>0;){if(h===a[y].tagName){s=(a=a.slice(0,y))[y-1].children;break}y-=1}for(var b=[],g=void 0;c<u&&"tag-end"!==(g=t[c]).type;)b.push(g.content),c++;c++;var m=[];if(s.push({type:"element",tagName:f.content,attributes:b,children:m}),!(g.close||(0,n.arrayIncludes)(o.voidTags,h))){a.push({tagName:h,children:m});var _={tokens:t,options:o,cursor:c,stack:a};i(_),c=_.cursor}}}else s.push(l),c++}e.cursor=c}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n={tagName:null,children:[]};return i({tokens:e,options:t,cursor:0,stack:[n]}),n.children},t.hasTerminalParent=r,t.parse=i});e(i);i.hasTerminalParent,i.parse;var o=t(function(e,t){function n(e,t){var n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}function r(e){var t=e.charAt(0),n=e.length-1;return('"'===t||"'"===t)&&t===e.charAt(n)?e.slice(1,n):e}function i(e){return e.map(function(e){var t=n(e.trim(),"=");return{key:t[0],value:"string"==typeof t[1]?r(t[1]):null}})}Object.defineProperty(t,"__esModule",{value:!0}),t.splitHead=n,t.unquote=r,t.format=function e(t){return t.map(function(t){var n=t.type;if("element"===n){var r=t.tagName.toLowerCase(),o=i(t.attributes),a=e(t.children);return{type:n,tagName:r,attributes:o,children:a}}return{type:n,content:t.content}})},t.formatAttributes=i});e(o);o.splitHead,o.unquote,o.format,o.formatAttributes;var a=t(function(e,t){function r(e){return e.reduce(function(e,t){var n=t.key,r=t.value;if(null===r)return e+" "+n;var i=-1!==r.indexOf("'")?'"':"'";return e+" "+n+"="+i+r+i},"")}function i(e,t){return e.map(function(e){if("text"===e.type)return e.content;if("comment"===e.type)return"\x3c!--"+e.content+"--\x3e";var o=e.tagName,a=e.attributes,s=e.children;return(0,n.arrayIncludes)(t.voidTags,o.toLowerCase())?"<"+o+r(a)+">":"<"+o+r(a)+">"+i(s,t)+"</"+o+">"}).join("")}Object.defineProperty(t,"__esModule",{value:!0}),t.formatAttributes=r,t.toHTML=i,t.default={toHTML:i}});e(a);a.formatAttributes,a.toHTML;var s=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.childlessTags=["style","script","template"],t.closingTags=["html","head","body","p","dt","dd","li","option","thead","th","tbody","tr","td","tfoot","colgroup"],t.closingTagAncestorBreakers={li:["ul","ol","menu"],dt:["dl"],dd:["dl"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table"],td:["table"]},t.voidTags=["!doctype","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]});e(s);s.childlessTags,s.closingTags,s.closingTagAncestorBreakers,s.voidTags;var u=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.parseDefaults=void 0,t.parse=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l,r=(0,n.default)(e,t),i=(0,u.default)(r,t);return(0,o.format)(i,t)},t.stringify=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return(0,a.toHTML)(e,t)};var n=c(r),u=c(i);function c(e){return e&&e.__esModule?e:{default:e}}var l=t.parseDefaults={voidTags:s.voidTags,closingTags:s.closingTags,childlessTags:s.childlessTags,closingTagAncestorBreakers:s.closingTagAncestorBreakers}});e(u);u.parseDefaults;var c=u.parse;u.stringify;function l(e){return function e(t){var n=[];t.forEach(function(t){var r=void 0;do{r=f()}while(n.indexOf(r)>=0);n.push(r),t.key=r,"element"===t.type&&t.children.length>0&&e(t.children)});return t}(c(e))}function f(){var e=Math.floor(1e6*Math.random());return e=e.toString(16)}function h(e,t){var n,r=t||document.createDocumentFragment();return n=e,"[object Array]"!=Object.prototype.toString.call(n)&&(e=[e]),function e(t,n){t.forEach(function(t,r){var i=void 0;!t.isReady||t.isDirty?"element"==t.type?(i=function(e,t,n){var r="turbine"==t.tagName?"div":t.tagName,i=document.createElement(r);!0===n?e.replaceChild(d(i,t.attributes),e.childNodes[t.index]):v(d(i,t.attributes),t,e);return i}(n,t,t.isDirty),t.ready(i),e(t.children,i)):("text"==t.type?i=function(e,t,n){var r=document.createTextNode(t.content);!0===n?e.replaceChild(r,e.childNodes[t.index]):v(r,t,e);return r}(n,t,t.isDirty):"comment"==t.type&&(i=function(e,t,n){var r=document.createComment(t.content);!0===n?e.replaceChild(r,e.childNodes[t.index]):v(r,t,e);return r}(n,t,t.isDirty)),t.ready(i)):"element"===t.type&&t.children.length>0&&"text"!=t.el.type&&e(t.children,!("FORM"===n.nodeName)&&n[r]?n[r]:n.childNodes[r])})}(e,r),r}function d(e,t){return t.forEach(function(t){e.setAttribute(t.key,t.value)}),e}function v(e,t,n){n.childNodes.hasOwnProperty(t.index)?n.insertBefore(e,n.childNodes[t.index]):n.appendChild(e)}var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},b=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},_=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},k=function(){function e(){y(this,e),this.subs=[]}return b(e,[{key:"addSub",value:function(e){this.subs.indexOf(e)<0&&(this.subs.push(e),e.deps.push(this))}},{key:"notify",value:function(e,t){this.subs.forEach(function(n){void 0!=n&&n.update(e,t)})}}]),e}(),O=function(){function e(t,n,r){y(this,e);var i=arguments.length;2==i||3==i?(this.recall=r,this.observe(t,n)):1==i&&(this.recall=n)}return b(e,[{key:"observe",value:function(e,t){var n=Object.prototype.toString.call(t),r=void 0;"[object Object]"!=n&&"[object Array]"!=n||(r=t.__ob__?t.__ob__:e.__ob__?e.__ob__:"[object Array]"==n?new j(e,this):new x(e,this),this.loopObj(e,t,r),"[object Array]"==n&&this.replaceArrayProperty(e,r))}},{key:"loopObj",value:function(e,t,n){var r=this;Object.keys(t).forEach(function(i){r.observeObj(e,t,i,n)})}},{key:"observeObj",value:function(e,t,n,r){var i=this,o=r.dep,a=t[n],s=void 0;t instanceof Array?e[n]=a:Object.defineProperty(e,n,{get:function(){var e=k.target;return E(a)&&(o=a.__ob__.dep),null==e&&void 0==e||o.addSub(e),a},set:function(e){e!==a&&(s=a,a=e,s instanceof Object?T(s,a):o.notify(),i.recall&&i.recall(a))},enumerable:!0,configurable:!0}),this.observe(e[n],t[n])}},{key:"replaceArrayProperty",value:function(e,t){var n=Array.prototype,r=Object.create(n),i=t.dep,o=this;["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(t){Object.defineProperty(r,t,{value:function(){var r=e.concat();n[t].apply(e,arguments),e.forEach(function(t,n){!E(t)&&t instanceof Object&&(o.observe(t,t),n<r.length-1&&T(r[n],e[n]))}),i.notify(),o.recall&&o.recall()},enumerable:!1,configurable:!0,writable:!0})}),function(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var i=n[r],o=Object.getOwnPropertyDescriptor(t,i);o&&o.configurable&&Object.defineProperty(e,i,o)}}(e,r),t.value=e}}]),e}(),x=function(){function e(t,n){y(this,e),this.dep=new k,this.react=n,this.value=t,Object.defineProperty(t,"__ob__",{enumerable:!1,value:this})}return b(e,[{key:"update",value:function(e,t){var n={};w(this.value,e)?t instanceof Object?(n=t instanceof Array?[]:{},this.react.observe(n,t),this.value[e]=n):this.value[e]=t:(n[e]=t,this.react.observeObj(this.value,n,e,this),this.dep.notify(),this.react.recall&&this.react.recall())}},{key:"destroy",value:function(e,t){var n=void 0,r=void 0;arguments.length>0?(r=!!(n=E(this.value[e])&&this.value[e].__ob__)&&n.dep,delete this.value[e],this.value instanceof Array&&(this.value.length-=1)):r=(n=this).dep,n&&(Object.keys(n.value).forEach(function(t){var n=t.__ob__;E(t)&&(n.destroy(),n.value[e]=null)}),r.subs.forEach(function(e){return e.unwatch()})),!0===t&&this.react.recall&&this.react.recall()}}]),e}(),j=function(e){function t(e,n,r){return y(this,t),_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r))}return m(t,x),b(t,[{key:"update",value:function(e,t){var n=w(this.value,e),r=[],i=this.value[e];r[e]=t,E(t)?this.value[e]=t:this.react.observeObj(this.value,r,e,this),n&&T(i,t),this.dep.notify(),this.react.recall&&this.react.recall()}}]),t}();function E(e){return(e instanceof Object||e instanceof Array)&&void 0!=e.__ob__}function N(e){return E(e)?e.__ob__:null}function w(e,t){return Object.getOwnPropertyDescriptor(e,t)}function T(e,t){var n,r,i,o=N(e),a=N(t);if(a&&o){n=o.dep,r=a.dep,i=n.subs,r.subs=r.subs.concat(i),i.forEach(function(e){void 0!=e&&e.deps.push(r)}),o.dep.notify(),o.dep.subs.length=0;var s=Object.keys(t);Object.keys(e).forEach(function(n,r){E(e[n])&&s[r]&&T(e[n],t[s[r]])})}}function A(e,t){return e=e.replace(/&amp;/g,"&"),new Function("with(this){return "+e+"}").call(t)}var $=function(){function e(t,n,r){y(this,e);var i=void 0===r?"undefined":p(r),o=void 0,a=void 0,s=void 0;"function"===i?(o=r,s=!1):"object"===i&&(o=r.handler,a=r.immediate,s=r.deep||!1),k.target=this,this.deps=[],this.name=n,this.vm=t,this.value=this.get(),this.handler=o,this.deep=s,this.immediate=a,k.target=null,!0===s&&P.call(this,this.value),a&&this.update()}return b(e,[{key:"update",value:function(e){var t=this.value,n=this.get();if(this.value=n,this.immediate)return this.handler.call(this.vm,n,t),this.immediate=!1;this.deep&&!this.immediate&&void 0!=e&&P.call(this,e),(t!==n||t instanceof Object)&&this.handler.call(this.vm,n,t)}},{key:"get",value:function(){return A(this.name,this.vm)}},{key:"unwatch",value:function(){var e=this;this.deps.forEach(function(t){var n=t.subs.indexOf(e);t.subs.splice(n,1,void 0)}),this.deps.length=0,this.vm=null,this.node=null,this.recall=null,this.dep=null,this.value=null}}]),e}();function P(e){var t=this,n=void 0;if(e instanceof Array)n=e;else{if(!(e instanceof Object))return k.target=this,void(k.target=null);n=Object.keys(e)}n.forEach(function(n,r){var i=e instanceof Array;k.target=t,i?e[r]:e[n],k.target=null,n instanceof Object&&P.call(t,n)})}var C=function(){function e(t){y(this,e),this.type=t.type,this.el=null,this.oberver=[],this.watchers=[],this.directives=[],this.key=t.key,this.isReady=!1,this.display=!0,this.parse=!1,this.index=null,this.data={},this._if=null,"element"===t.type?(this.children=t.children,this.isComponent=!1,this.attributes=t.attributes,this.context=null,this.tagName=t.tagName,this.reference=t):this.content=t.content}return b(e,[{key:"inserted",value:function(e){this.oberver.push(e)}},{key:"ready",value:function(e){var t=this;this.el=e,this.isDirty=!1,this.directives.length>0&&!this.isReady&&this.directives.forEach(function(e){e.bind?e.bind(t.el,e.binding,t):e.update&&e.update(t.el,e.binding,t)}),this.isReady=!0,this.oberver.forEach(function(n){return n.call(t,e)}),this.oberver.length=0}},{key:"remove",value:function(){var t=this;!1!==this.isReady&&(this.directives&&(this.directives.forEach(function(e){e.unbind&&e.unbind(t.el,e.binding,t)}),this.directives.length=0),this.watchers.forEach(function(e){return e.unwatch()}),this.isComponent?this.data.component._destroy():("element"==this.type&&this.children.forEach(function(t){t instanceof e&&t.remove()}),this.el.parentNode&&this.el.parentNode.removeChild(this.el)),this.oberver=null,this.el=null,this.context=null,this.children=null,this.attributes=null,this.directives=null,this.component=null,this.reference=null,this.data=null,this.watchers=null)}}]),e}(),D=[Number,String,Boolean];function L(e,t){if(!e)return e;t=1==arguments.length||t;var n,r=void 0;if(D.forEach(function(t){e instanceof t&&(r=t(e))}),void 0===r)if("[object Array]"===Object.prototype.toString.call(e)){r=[];var i=!1;e.forEach(function(e){if(!i){if("turbine"===e.tagName&&(i=!0,r.length=0),"comment"===e.type)return;r.push(L(e,t))}})}else if("object"==(void 0===e?"undefined":p(e)))for(var o in r="element"==(n=e).type||"text"==n.type?new C(e):{},e)r[o]=t||"children"!==o?L(e[o],t):[];else r=e;return r}var M=void 0;function S(){if(M)return M;M=function(e){function t(e){y(this,t);var n=e.data,r=e.props,i=e.vNode,o={};if("function"==typeof n)o=n();else if(void 0!=n){return void 0,_(s,void 0)}void 0!=r&&r instanceof Array&&(r.forEach(function(e){var t=H(i.attributes,function(t){return t.key===e});null!=t&&(o[e]=t.value)}),delete e.prop);var a=g({},e,{data:o,_isComponent:!0,$parent:i.context,slots:function(e){var t={};return e.children.forEach(function(e){var n="element"==e.type,r=n&&H(e.attributes,function(e){return"slot"==e.key});r?t[r.value]=e:n&&(t.default=t.default instanceof Array?t.default.concat(e):[e])}),t}(i)}),s=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a));return i.data.component=s,i.el=s.$el,i.tagName=s.$el.tagName.toLowerCase(),s}return m(t,e),t}(K.prototype._init)}function H(e,t){var n=void 0,r=void 0;for(n=0;n<e.length;n++)if(t(r=e[n]))return r}var R=void 0,q=[{directive:"if$",level:0,use:function(e){var t=e.binding,n=e.vNode;n._if=Boolean(t.result),t.result||(n.type="comment",n.content="",n.children.length=0),t.lastResult=t.result},update:function(e,t,n){if(t.lastResult===t.result)return n.isDirty=!1;!0===t.result?(n.type="element",n.children=L(n.reference.children),n.isComponent&&null===n.data.component&&n.inserted(function(e){var t=n.reference.tagName,r=n.context._c[t];n.context._components.push(new S(g({el:e,vNode:n},r)))})):(n.type="comment",n.content="",n.children.forEach(function(e){return e.remove()}),n.children.length=0,n.isComponent&&n.data.component&&n.inserted(function(){n.data.component._destroy(),n.data.component=null})),n.isDirty=!0,n._if=Boolean(t.result),t.lastResult=t.result}},{directive:"else$",level:0,preventDefaultVal:!0,use:function(e){var t=e.vNode,n=e.domTree,r=t.index,i=void 0;do{i=n[r-=1]}while(null===i._if);if(void 0===i||null===i._if)throw'Turbine couldn\'t "t-if" attribute on previous nodes ';i._if&&(t.type="comment",t.content="",t.children.length=0),t.data.originNode=i,t._else=!i._if},update:function(e,t,n){var r=n.data.originNode;if(!r._if===n._else)return n.isDirty=!1;n.isDirty=!0,n._else=!r._if,r._if?(n.type="comment",n.content="",n.children.forEach(function(e){return e.remove()}),n.children.length=0):(n.type="element",n.children=L(n.reference.children))}},{directive:"for$",level:0,preventDefaultVal:!0,use:function(e,t,n){var r=e.vNode,i=e.domTree,o=e.properties,a=void 0,s=void 0,u=void 0,c=e.binding.value.split(" in "),l=c[0].match(/^\(.*\)/g),f=Q(c[1]);if(null!=l&&1==l.length){var h=l[0].match(/\w+/g);a=h[0],s=h[1]}else a=Q(c[0]);r.watchers.push(new $(o,f,{handler:function(e){if(r.data.reference=isNaN(e)?e:function(){for(var t=[],n=Number(e);t.length<n;)t.push(t.length);return t}(),void 0===u)V({inner:a,counter:s,domTree:i,properties:o,vNode:r}),u=Object.keys(e).length;else{var t=Object.keys(e).length;t>u?V({inner:a,counter:s,domTree:i,properties:o,vNode:r,startAt:u-1}):t<u&&(i.slice(r.index+1+t,r.index+1+u).forEach(function(e){i.splice(i.indexOf(e),1),e.remove()}),i.forEach(function(e,t){e.index=t})),u=t}},immediate:!0})),r.type="comment",r.content="",r.attributes=[],n()}},{directive:"show",level:1,update:function(e,t,n){var r=this;if(n.isDirty)return n.inserted(function(e){return r.update(e,t,n)});t.result?e.style.display=t.args||"block":e.style.display="none"}},{directive:"on",level:1,preventDefaultVal:!0,bind:function(e,t,n){if(!1!==n._if){var r=Object.create(n.context),i=[],o=void 0,a=void 0;if(t.args.length>0)o=t.args,a=function(e){var n=Array.prototype.slice.call(arguments);if(/\((.*?)\)/.test(t.value))return e instanceof Event&&(r.$event=e),A(t.value,r);var i=A(t.value,r);i instanceof Function&&i.apply(r,n)},i.push({event:o,fn:a});else{var s=A(t.value,r);s instanceof Object&&Object.keys(s).forEach(function(e){o=e,(a=s[e])instanceof Function&&i.push({event:o,fn:a})})}n.data.events=i,!1===n.isComponent&&i.forEach(function(t){e.addEventListener(t.event,t.fn)})}},update:function(e,t,n){var r=this;n.isDirty&&n.inserted(function(e){!0===n._if&&r.bind(e,t,n)})},unbind:function(e,t,n){!1===n.isComponent&&!0===n._if&&(n.data.events.forEach(function(t){e.removeEventListener(t.event,t.fn)}),n.data.events.length=0)}},{directive:"bind",level:1,bind:function(e,t,n){!1!==n._if&&I(e,t,n)},update:function(e,t,n){var r=this;n.isDirty?n.inserted(function(e){!0===n._if&&r.update(e,t,n)}):I(e,t,n)}},{directive:"model$",level:1,bind:function(e,t,n){if(!1!==n._if){var r="textarea"==n.tagName?"text":W(n.attributes,function(e){return"type"==e.key}).value||"text",i=t.value;e.addEventListener("input",t.inputEvent=function(e){A(i,n.context)!=e.target.value&&A(i+"= '"+e.target.value+"'",n.context)}),e.addEventListener("change",t.changeEvent=function(t){var o=A(i,n.context);if("checkbox"==r&&o instanceof Array)if(1==e.checked)o.push(e.value);else{var a=o.indexOf(e.value);o.splice(a,1)}else o!=t.target.value&&(o=t.target.value)})}},update:function(e,t,n){if(n.isDirty)return n.inserted(function(e){!0===n._if&&R.bind(e,t,n)});var r="textarea"==n.tagName?"text":W(n.attributes,function(e){return"type"==e.key}).value||"text";"radio"==r?e.value==t.result?e.checked=!0:e.checked=!1:"checkbox"==r?t.result.indexOf(e.value)>=0?e.checked=!0:e.checked=!1:e.value=t.result},unbind:function(e,t){e.removeEventListener("input",t.inputEvent),e.removeEventListener("change",t.changeEvent)}},{directive:"^ref$",level:3,display:!0,preventDefaultVal:!0,bind:function(e,t,n){if(!1!==n._if){var r=n.context,i=r._refs,o=r.$refs,a=i[t.value],s=o[t.value],u=n.key;void 0==a?(i[t.value]=[u],o[t.value]=e):(a.push(u),o[t.value]=s instanceof Array?s.concat(e):[s,e])}},update:function(e,t,n){var r=this;if(n.isDirty)return!1===n._if&&this.unbind(e,t,n),n.inserted(function(e){!0===n._if&&r.bind(e,t,n)})},unbind:function(e,t,n){var r=n.key,i=t.value,o=n.context,a=o._refs,s=o.$refs,u=a[i],c=s[i];c instanceof Array?(c.splice(c.indexOf(n.el),1),u.splice(u.indexOf(r),1)):(a[i]=void 0,s[i]=void 0)}}];function I(e,t,n){var r=t.result,i=n.data.component;if("[object Object]"==r.toString())if(!1===n.isComponent){var o="",a=void 0;""!==t.args?(Object.keys(r).forEach(function(e){a=r[e],o+="boolean"==typeof a?a?e+" ":"":e+": "+r[e]+";"}),B(n,e,t.args,o)):Object.keys(r).forEach(function(t){a=r[t],B(n,e,t,a)})}else Object.keys(r).forEach(function(t){n.isComponent?void 0===i?n.attributes.push({key:t,value:r[t]}):i.$data.__ob__.update(t,r[t]):B(n,e,t,r[t])});else r instanceof Array?n.isComponent?void 0===i?n.attributes.push({key:t.args,value:r[0]}):i.$data.__ob__.update(t.args,r[0]):B(n,e,t.args,r[0]):n.isComponent?void 0===i?n.attributes.push({key:t.args,value:r}):i.$data.__ob__.update(t.args,r):B(n,e,t.args,r)}function V(e){var t=e.properties,n=e.vNode,r=e.inner,i=e.counter,o=e.domTree,a=e.startAt,s=void 0,u=0,c=isNaN(n.data.reference)?n.data.reference:function(){for(var e=[],t=Number(n.data.reference);e.length<t;)e.push(e.length);return e}(),l=function(e){if(void 0!=a&&u<=a)return u+=1,"continue";var l={},f=Object.create(t);(s=L(n.reference)).attributes=s.attributes.filter(function(e){return"t-for"!=e.key}),s.directives.push(n.directives[0]),s.index=n.index+(u+=1),s.context=f,c instanceof Array?(Object.defineProperty(f,r,{get:function(t){var r=n.data.reference;return k.target&&(r.__ob__.dep.addSub(k.target),t.watchers.push(k.target)),r[e]}.bind(null,s),enumerable:!0,configurable:!0}),i&&(l[i]=e)):c instanceof Object&&(Object.defineProperty(f,r,{get:function(e,t){var r=n.data.reference;return k.target&&(r.__ob__.dep.addSub(k.target),t.watchers.push(k.target)),Object.keys(r)[e-1]}.bind(null,u,s),enumerable:!0,configurable:!0}),i&&(l[i]=u-1)),f.$data.__ob__.react.observe(f,l),o.splice(s.index,0,s)};for(var f in c)l(f);if(u>0)for(var h=n.index+u+1;h<o.length;h++)o[h].index=h}function B(e,t,n,r){if(1===t.nodeType){var i=W(e.attributes,function(e){return e.key==n});if("boolean"==typeof r&&!r){if(!i)return t.removeAttribute(n);r=!1}var o=t.attributes[n];o?o.nodeValue=(i?i.value+" ":"")+r||"":t.setAttribute(n,r)}}function W(e,t){var n=void 0,r=void 0;for(n=0;n<e.length;n++)if(t(r=e[n]))return r}function Q(e){return e.replace(/\s/g,"")}var F=function(){function e(t,n){return y(this,e),this.directives=n._dir,this.components=n._c,this.parse(t,n)}return b(e,[{key:"parse",value:function(e,t){for(var n=this,r=function(r){var o=e[r];if(o.index=r,o.isReady)return o.directives.forEach(function(e){var t=e.binding;e.preventDefaultVal||null==t.value||(t.result=A(t.value,o.context)),e.update&&e.update(o.el,t,o)}),o.children&&"element"==o.type&&n.parse(o.children,o.context||t,o.el),"continue";if(o.context=o.context||t,"text"==o.type)!function(e,t,n,r){var i=e.content.match(/{{([^}}]*?)}}/g);null==i&&void 0==i||(i.forEach(function(t){var n=t.match(/[^{{}}]*/g)[2];e.inserted(function(i){e.watchers.push(new $(r,n,{handler:function(n){var r=e.content,o=r.indexOf(t);r=r.slice(0,o)+n+r.slice(o+t.length),i.nodeValue=r},immediate:!0}))})}),t[n]=e)}(o,e,r,t);else if("element"==o.type){if(n.components.hasOwnProperty(o.tagName))o.isComponent=!0;else if("slot"==o.tagName){var a="default";o.attributes.forEach(function(e){"name"==e.key&&(a=e.value)});var s=!!t.slots&&t.slots[a],u=[r,1];s&&(s instanceof Array?s:[s]).forEach(function(e){return u.push(e)}),[].splice.apply(e,u)&&(r-=1)}n.analyseHook(o,e,o.context||t)}i=r},i=0;i<e.length;i++)r(i);return e}},{key:"analyseHook",value:function(e,t,n){var r=this,i=new Z(function(t,i,o){if(1!=e.isComponent)r.parse(i||e.children,o||n);else{var a=t||e,s=a.tagName,u=r.components[s];a.tagName="div",a.inserted(function(e){n._components.push(new S(g({el:e,vNode:this},u)))})}});e.attributes.concat().forEach(function(o){r.matchHook(o,function(r){var a=o.key,s=a.indexOf(":");o.args=s>=0?a.slice(s+1):"",i.push(r,{vNode:e,domTree:t,properties:n,binding:o})})}),i.process()}},{key:"matchHook",value:function(e,t){this.directives.forEach(function(n){var r=n.directive;A("/"+((r.indexOf("^")<0?"^t-":"")+r)+"/").test(e.key)&&t(n)})}}]),e}(),Z=function(){function e(t){y(this,e),this.queue=[],this.presentQueue=[],this._flag=!0,this.copy=[],this.recall=t}return b(e,[{key:"push",value:function(e,t){var n=e.level;void 0==this.queue[n]?this.queue[n]=[{hook:e,args:t}]:this.queue[n].push({hook:e,args:t})}},{key:"process",value:function(){var e=this,t=[null];if(0===this.queue.length)return this.recall();this.queue.forEach(function(n,r){e.presentQueue=n,void 0!==n&&e.presentQueue.forEach(function(n,i){1==e._flag&&(t.forEach(function(t){var o=n.args.binding=g({},n.args.binding);if(!0!==n.hook.preventDefaultVal&&null!=o.value){var a=t?t.properties:n.args.properties,s=o.value;o.result=A(s,a)}var u=g(n.args,t),c=u.vNode,l=Object.create(n.hook);l.binding=o,c.directives.push(l),z(c.attributes,o.key),e.callHandler(n,u),c.context=u.properties,e.copy.forEach(function(e){e.vNode.directives.push(l),e.vNode.context=e.properties,z(e.vNode.attributes,o.key)}),!0===e._flag&&r==e.queue.length-1&&i==e.presentQueue.length-1&&(e.copy.length>0?e.copy.forEach(function(t){e.recall(t.vNode,t.vNode.children,t.properties)}):e.recall(u.vNode,u.vNode.children,u.properties))}),t=0===e.copy.length?t:e.copy,e.copy=[])})})}},{key:"callHandler",value:function(e,t){e.hook.use&&e.hook.use(t,this.insertQueue.bind(this),this.stop.bind(this))}},{key:"insertQueue",value:function(e,t,n){this._flag=!0,this.copy.push({vNode:e,domTree:t,properties:n})}},{key:"stop",value:function(){this._flag=!1}}]),e}();function z(e,t){var n=void 0;e.forEach(function(e,r){e.key==t&&(n=r)}),e.splice(n,1)}var G=[],J={};var K=function e(t){return t instanceof e.prototype._init?t:new e.prototype._init(t)};return K.prototype={_init:function(e){var t=this,n=e.el,r=e.template,i=e.components,o=e.directives,a=e.methods,s=e.data,u=e.watch;e.slots;if(this._refs={},this.$refs={},this._components=[],this._dir=[],this._vnode=[],this.$el=null,this._continued=!1,Object.keys(e).forEach(function(n){t.hasOwnProperty(n)||["components","directives","methods","data","watch","el"].indexOf(n)<0&&(t[n]=e[n])}),void 0!=n?("string"==typeof n&&(n=document.body.querySelector(n)),r=r||n.outerHTML,this.$jsonTree=l(r),this._continued=!0):void 0!=r&&(this.$jsonTree=l(r),this._continued=!1),G.forEach(function(e){t._dir.push(e)}),o instanceof Object)for(var c in o)K.directive(this,c,o[c]);(this._c=g({},J),i&&"object"==(void 0===i?"undefined":p(i))&&Object.keys(i).forEach(function(e){K.component(t,e,i[e])}),this._setMethods(a),this.beforeCreate&&this.beforeCreate(),void 0!=s&&"object"==(void 0===s?"undefined":p(s))&&this._observe(s),"object"==(void 0===u?"undefined":p(u)))&&Object.keys(u).forEach(function(e){t.$watch(e,u[e])});return this.created&&this.created(),void 0!=n&&null!=n&&this._render(n),this},_render:function(e){var t=this,n=e.parentNode;this._vnode=new F(L(this.$jsonTree),this);var r=h(this._vnode);if(this._vnode.forEach(function(e){"turbine"==e.tagName&&(t.$el=e.el)}),null===this.$el)throw"couldn't find turbine as a root html tag";n.replaceChild(r,e),this._continued=!0,this.mounted&&this.mounted()},_observe:function(e,t){var n,r,i,o=this,a=void 0===e?"undefined":p(e),s=arguments.length,u=void 0;if(1==s&&"object"==a)u=e;else{if(2!=s||"string"!=a)return;(u={})[e]=t}n=this,r=u,i=function(e){delete u[e]},Object.keys(r).forEach(function(e){n.hasOwnProperty(e)&&i(e)});var c,l=void 0;new O(this.$data||(c=this,Object.defineProperty(c,"$data",{value:{},enumerable:!1}),c.$data),u,function(){clearTimeout(l),l=setTimeout(function(){l=null,o._updateView()})}),Object.keys(this.$data).forEach(function(e){Object.defineProperty(o,e,{enumerable:!0,configurable:!0,get:function(){return o.$data[e]},set:function(t){o.$data[e]=t}})})},_setMethods:function(e){var t=this;"object"==(void 0===e?"undefined":p(e))&&Object.keys(e).forEach(function(n){t.hasOwnProperty(n)||(t[n]=e[n])})},_updateView:function(){this._continued&&(new F(this._vnode,this),h(this._vnode,[this.$el]))},_destroy:function(){if(this._components.length>0&&this._components.forEach(function(e){return e._destroy()}),this._isComponent){var e=this.$parent._components.indexOf(this);this.$parent._components.splice(e,1)}var t=!!this.$data&&this.$data.__ob__;t&&t.destroy(),this._vnode[0].remove(),this._vnode=null,this.$jsonTree=null,this.$el=null,this.$refs=null,this._refs=null,this._dir=null,this._components=null,this._c=null,this.$parent=null,this.vNode=null}},K._turbine=K.prototype,K._turbine._init.prototype=K.prototype,K.use=function(e,t){e instanceof Object&&e.install(K,t)},K.set=K._turbine.$set=function(e,t,n){var r=arguments.length,i=void 0;if(2==r&&"string"==typeof e&&this instanceof K.prototype._init)n=t,i=e.split("."),e=this.$data,t=i[i.length-1],i.forEach(function(n,r){if(e.hasOwnProperty(n)&&r<i.length-1)e=e[n];else{var o=n.match(/\[\w+\]/g),a=n.match(/^(\w+)/)[0];if(null!=o&&o.length>1)o.map(function(e,t){o[t]=e.replace("[","").replace("]","")}),o.unshift(a),o.forEach(function(n,a){a<=o.length-2||r<=i.length-1?e=e[n]:r==i.length-1&&(t=n)});else if(r<i.length-1)throw"reference Error"}});else if(3!==r&&!(e instanceof Object))throw"arguments Error";e.__ob__.update(t,n,!0)},K.delete=K._turbine.$delete=function(e,t){if("object"!=(void 0===e?"undefined":p(e))||!e.hasOwnProperty("__ob__"))throw"target must be an Object or Array and it should have been observed";e.__ob__.destroy(t,!0)},K._turbine.$emit=function(e){var t=this,n=!1,r=Array.prototype.slice.call(arguments,1);void 0!=this.vNode&&this.vNode.data.events&&this.vNode.data.events.forEach(function(i){i.event==e&&(n=!0,i.fn.apply(t.vNode.context,r))}),!n&&this.$parent&&this.$parent.$emit(e,r)},K._turbine.$watch=function(e,t){new $(this,e,t)},K.hangup=K._turbine.$hangup=function(e){this instanceof K._turbine._init?(this.beforeHangup&&this.beforeHangup(),this._continued=!1,this._vnode[0].remove(),this._vnode=null):e instanceof K._turbine._init&&e.$hangup()},K.restart=K._turbine.$restart=function(e){this instanceof K._turbine._init?this._render(this.$el):e instanceof K._turbine._init&&e.$restart(e)},K._turbine.$mount=function(e){var t=e;if(e instanceof HTMLElement)t=e;else{if("string"!=typeof e)throw"arguments error";t=document.body.querySelector(e)}return this._render(this.$el=t),this},K.component=function(e,t){K._components=K._components||{},K._components[e]=t},K.directive=function(e,t,n){var r={};if(2==arguments.length&&(n=t,t=e,e=null),"function"==typeof n)r.bind=r.update=n;else{if("object"!==(void 0===n?"undefined":p(n)))throw"arguments error\n"+n;r=n}r.directive=t;var i=g({level:4,display:!1,preventDefaultVal:!1},r);null===e?G.push(i):e._dir.push(i)},q.forEach(function(e){K.directive(e.directive,e)}),K.component=function(e,t){var n=void 0;3==arguments.length?(n=arguments[0]._c,e=arguments[1],t=arguments[2]):n=J;var r=/([A-Z])/g.exec(e),i=void 0;r?r.forEach(function(t){i=e.replace(t,"-"+t.toLowerCase())}):i=e,n.hasOwnProperty(i)||(n[i]=t)},K});
